<!DOCTYPE html>
<meta charset="utf-8">
<style>

.link{
	stroke: #000;
}

.node{
	stroke: #000000;
}

</style>
<body>
	<script src="d3/d3.js"></script>
<script>

var width = 1500,
	height = 1000;

var color = d3.scale.category20();

var svg = d3.select("body").append("svg")
	.attr("width", width)
	.attr("height", height);

var force = d3.layout.force()
	.size([width,height]);

force.linkDistance(width/20)

function dragstart(d) { 
 d3.selectAll("circle").classed("others",true);  
 d3.select(this).classed("others", false); 

}  

d3.csv("sample_links.csv", function(links){
	var nodesByName = {};

	// Create nodes for each unique source and target.
	links.forEach(function(link) {
		link.source = nodeByName(link.source);
		link.target = nodeByName(link.target);
	});

	// Extract the array of nodes from the map by name.
	var nodes = d3.values(nodesByName);

	// Create the link lines.
	var link = svg.selectAll(".link")
		.data(links)
		.enter().append("line")
		.attr("class","link");

	// Create the node circles.
	var node = svg.selectAll(".node")
		.data(nodes)
		.enter().append("circle")
		.attr("class","node")
		.attr("r", 10)
		.style("fill", function(d){return color(d.cluster)})
		.call(force.drag);

	// Start the force layout
	force
		.nodes(nodes)
		.links(links)
		.on("tick",tick)
		.gravity(0.01)
		.start();

	function tick() {
		link.attr("x1", function(d){return d.source.x;})
			.attr("y1", function(d){return d.source.y;})
			.attr("x2", function(d){return d.target.x;})
			.attr("y2", function(d){return d.target.y;})

		node.attr("cx", function(d){return d.x;})
		node.attr("cy", function(d){return d.y;});
	}

	function nodeByName(name){
		return nodesByName[name] || (nodesByName[name] = {name: name});
	}
});

</script>